{# templates/inventory/maintenance/_table.html #}
{% load static %}

{% if object_list %}
  <div class="bg-white rounded-xl shadow-sm ring-1 ring-gray-100 overflow-hidden">
    <table class="min-w-full divide-y divide-gray-100">
      <thead class="bg-gray-50">
        <tr class="text-left text-xs font-semibold text-gray-500">
          <th class="px-3 py-2 text-left font-semibold text-gray-700">Equipo</th>
          <th class="px-3 py-2 text-left font-semibold text-gray-700">Tipo</th>
          <th class="px-3 py-2 text-left font-semibold text-gray-700">Frecuencia</th>
          <th class="px-3 py-2 text-left font-semibold text-gray-700">Última fecha</th>
          <th class="px-3 py-2 text-left font-semibold text-gray-700">Notas</th>
          <th class="px-3 py-2 text-right font-semibold text-gray-700">Acciones</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-100 bg-white">
        {% for m in object_list %}
          <tr class="text-sm text-gray-700">
            <td class="px-6 py-3">
              <div class="font-medium text-gray-900">{{ m.equipment }}</div>
            </td>

            <td class="px-6 py-3">
              <span class="inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800">
                {{ m.get_maintenance_type_display }}
              </span>
            </td>

            <td class="px-6 py-3">
              {% if m.frequency %}
                <span class="inline-flex items-center rounded-md bg-gray-100 px-2 py-0.5 text-xs text-gray-700">
                  {{ m.get_frequency_display }}
                </span>
              {% else %} — {% endif %}
            </td>

            <td class="px-6 py-3">
              {{ m.last_date|date:"Y-m-d"|default:"—" }}
            </td>

            <td class="px-6 py-3">
              <span class="line-clamp-2">{{ m.notes|default:"" }}</span>
            </td>

            <td class="px-6 py-3">
              <div class="flex items-center justify-end gap-2">
                {# Editar (verde) #}
                <button type="button"
                        class="inline-flex items-center justify-center rounded-full p-2
                               border border-green-200 text-green-700 bg-green-50
                               hover:bg-green-100 focus:outline-none"
                        title="Editar mantenimiento" aria-label="Editar" data-loading-btn
                        hx-get="{% url 'inventory:maintenance_update' m.id %}"
                        hx-target="#modal" hx-swap="innerHTML"
                        hx-indicator="#global-spinner">
                  <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M12 20h9" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L8 18l-4 1 1-4L16.5 3.5Z"
                          stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round" />
                  </svg>
                  <span class="sr-only">Editar</span>
                </button>

                {# Eliminar (rojo) #}
                <button type="button"
                        class="inline-flex items-center justify-center rounded-full p-2
                               border border-red-200 text-red-700 bg-red-50
                               hover:bg-red-100 focus:outline-none"
                        title="Eliminar mantenimiento" aria-label="Eliminar" data-loading-btn
                        hx-post="{% url 'inventory:maintenance_delete' m.id %}"
                        hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                        hx-confirm="¿Seguro que deseas eliminar este mantenimiento?"
                        hx-indicator="#global-spinner">
                  <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M3 6h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" />
                    <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6" stroke="currentColor" stroke-width="2" />
                    <path d="M10 11v6M14 11v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                  </svg>
                  <span class="sr-only">Eliminar</span>
                </button>
              </div>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <!-- Estado vacío -->
  <div class="rounded-xl border border-dashed border-gray-300 bg-white p-10 text-center">
    <p class="text-gray-600">Aún no hay mantenimientos registrados.</p>
    <div class="mt-4">
      <button type="button"
              class="inline-flex items-center rounded-lg bg-atec-primary-600 px-4 py-2 text-sm font-medium text-white hover:bg-atec-primary-700 focus:outline-none"
              hx-get="{% url 'inventory:maintenance_create' company.id %}"
              hx-target="#modal" hx-swap="innerHTML">
        + Agregar mantenimiento
      </button>
    </div>
  </div>
{% endif %}
